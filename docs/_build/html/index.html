

<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Welcome to MCPlas toolbox! &#8212; MATLAB Sphinx Documentation Test  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/cloud.css?v=f9ae72be" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text:400,i,b,bi|Open+Sans:400,i,b,bi|Roboto+Mono:400,i,b,bi&amp;display=swap" type="text/css" />
    
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    
    
     
        <script src="_static/jquery.cookie.js"></script>
    

    
     
        <script src="_static/cloud.base.js"></script>
    

    
     
        <script src="_static/cloud.js"></script>
    

    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="SetGeometry" href="manual_rst_application/Generic1D/SetGeometry.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="manual_rst_application/Generic1D/SetGeometry.html" title="SetGeometry"
             accesskey="N">next</a> &nbsp; &nbsp;</li>
    <li><a href="#">MATLAB Sphinx Documentation Test  documentation</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">Welcome to MCPlas toolbox!</a></li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="welcome-to-mcplas-toolbox">
<h1>Welcome to MCPlas toolbox!<a class="headerlink" href="#welcome-to-mcplas-toolbox" title="Link to this heading">¶</a></h1>
<a class="reference internal image-reference" href="_images/Logo_version_2.jpg"><img alt="_images/Logo_version_2.jpg" class="align-center" src="_images/Logo_version_2.jpg" style="width: 256.75px; height: 221.75px;" /></a>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>The MCPlas toolbox represents a collection of MATLAB functions for the automated generation of an equation-based fluid-Poisson model for non-thermal plasmas in the multiphysics simulation software COMSOL.
Following the development of the new generation of the LXCat platform, all input data are prepared in a structured and interoperable JSON format and can be supplied and validated using existing JSON schemas.
The toolbox includes fully transparent, editable MATLAB source code and offers an advanced description of electron transport in addition to commonly used approaches in the plasma modelling community.
It supports one-dimensional and two-dimensional modelling geometries employing Cartesian, polar and cylindrical coordinate systems.</p>
<p>The plasma description provided by MCPlas is based on the equations of fluid-Poisson model</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}\frac{\partial}{\partial t}n_j
+ \nabla\cdot\mathbf{\Gamma}_j = S_j,
\label{eq:continuity}\\
%
\frac{\partial}{\partial t}w_\mathrm{e}
+\nabla\cdot\mathbf{Q}_\mathrm{e}
= -e_0\mathbf{\Gamma}_\mathrm{e}\cdot \mathbf{E} + \tilde{S}_\mathrm{e},
\label{eq:we}\\
%
-\nabla \cdot(\varepsilon_\mathrm{r}\varepsilon_0\nabla\phi)
= \sum_j q_j n_j,
\label{eq:poisson}\end{split}\]</div>
</div></blockquote>
<p>where the first equation represents the balance equations for the particle number densities <span class="math notranslate nohighlight">\(n_j\)</span> of species with index <span class="math notranslate nohighlight">\(j\)</span> (electrons, ions, neutrals),
charge <span class="math notranslate nohighlight">\(q_j\)</span> and particle flux <span class="math notranslate nohighlight">\(\mathbf{\Gamma}_j\)</span>. The second equation is the balance equation for the energy density <span class="math notranslate nohighlight">\(w_\mathrm{e}=n_\mathrm{e}u_\mathrm{e}\)</span> of electrons (<span class="math notranslate nohighlight">\(j = \mathrm{e}\)</span>) with the mean electron energy <span class="math notranslate nohighlight">\(u_\mathrm{e}\)</span> and energy flux <span class="math notranslate nohighlight">\(\mathbf{Q}_\mathrm{e}\)</span>. The third equation represents the Poisson equation for the self-consistent determination of the electric potential <span class="math notranslate nohighlight">\(\phi\)</span> and electric field <span class="math notranslate nohighlight">\(\mathbf{E}=-\nabla\phi\)</span>.
The elementary charge, the relative permittivity of the medium and the vacuum permittivity are denoted by <span class="math notranslate nohighlight">\(e_0\)</span>, <span class="math notranslate nohighlight">\(\varepsilon_\mathrm{r}\)</span> and <span class="math notranslate nohighlight">\(\varepsilon_0\)</span>, respectively.
The source terms <span class="math notranslate nohighlight">\(S_j\)</span> describe the gain and loss of particles due to collision and radiation processes, and <span class="math notranslate nohighlight">\(\tilde{S}_\mathrm{e}\)</span> accounts for the corresponding gain and loss of electron energy.
All variables (<span class="math notranslate nohighlight">\(n_j\)</span>, <span class="math notranslate nohighlight">\(w_\mathrm{e}\)</span>, <span class="math notranslate nohighlight">\(\mathbf{\Gamma}_j\)</span>, <span class="math notranslate nohighlight">\(\mathbf{Q}_\mathrm{e}\)</span>, <span class="math notranslate nohighlight">\(S_j\)</span>,  <span class="math notranslate nohighlight">\(\tilde{S}_\mathrm{e}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{E}\)</span>) are space- and time-dependent quantities.
To improve clarity and readability, the explicit notation of their dependence on <span class="math notranslate nohighlight">\((\mathbf{r},t)\)</span> is suppressed in the text.</p>
<p>The fluxes <span class="math notranslate nohighlight">\({\mathbf{\Gamma}}_\mathrm{h}\)</span> of heavy particles (<span class="math notranslate nohighlight">\(j=\mathrm{h}\)</span>) are expressed by the common drift-diffusion approximation (<em>Sigeneger, R. Winkler, IEEE Trans. Plasma Sci. 27 (5)
(1999) 1254</em>, <em>G. K. Grubert, M. M. Becker, D. Loffhagen, Phys. Rev. E 80 (2009) 036405</em>)</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\mathbf{\Gamma}_\mathrm{h}
= \mathrm{sgn}(q_\mathrm{h})n_\mathrm{h} b_\mathrm{h} \mathbf{E}
-D_\mathrm{h}\nabla n_\mathrm{h}\,, \label{eq:flux_particle}\]</div>
</div></blockquote>
<p>where,  <span class="math notranslate nohighlight">\(b_\mathrm{h}\)</span> and <span class="math notranslate nohighlight">\(D_\mathrm{h}\)</span> stand for the  mobility and diffusion coefficient of heavy species <span class="math notranslate nohighlight">\(\mathrm{h}\)</span>, respectively, while the function <span class="math notranslate nohighlight">\(\mathrm{sgn}(q_\mathrm{h})\)</span> defines the sign of <span class="math notranslate nohighlight">\(q_\mathrm{h}\)</span>.
Three options are offered by MCPlas for the definition of the electron flux <span class="math notranslate nohighlight">\({\mathbf{\Gamma}}_\mathrm{e}\)</span> and electron energy flux <span class="math notranslate nohighlight">\({\mathbf{Q}}_\mathrm{e}\)</span>.
The conventional drift-diffusion approximation (option <code class="docutils literal notranslate"><span class="pre">DDAc</span></code>) for these fluxes reads</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}\mathbf{\Gamma}_\mathrm{e}
= -n_\mathrm{e} b_\mathrm{e} \mathbf{E}
-\nabla(D_\mathrm{e}n_\mathrm{e})\,,\label{eq:JeDDAc}\\
%
\mathbf{Q}_\mathrm{e}
= -w_\mathrm{e} \tilde{b}_\mathrm{e} \mathbf{E}
-\nabla(\tilde{D}_\mathrm{e}w_\mathrm{e})\,,\label{eq:QeDDAc}\end{split}\]</div>
</div></blockquote>
<p>where <span class="math notranslate nohighlight">\(b_\mathrm{e}\)</span> and <span class="math notranslate nohighlight">\(D_\mathrm{e}\)</span> are electron transport coefficients, and <span class="math notranslate nohighlight">\(\tilde{b}_\mathrm{e}\)</span> and <span class="math notranslate nohighlight">\(\tilde{D}_\mathrm{e}\)</span> represent the electron energy transport coefficients.
The frequently used approach (option <code class="docutils literal notranslate"><span class="pre">DDA53</span></code>) employs the simplified form of the electron energy flux</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\mathbf{Q}_\mathrm{e}
= -\frac{5}{3} w_\mathrm{e} {b}_\mathrm{e} \mathbf{E}
-\frac{5}{3}\nabla({D}_\mathrm{e}w_\mathrm{e})\,.\label{eq:QeDDA53}\]</div>
</div></blockquote>
<p>The improved drift-diffusion approximation (option <code class="docutils literal notranslate"><span class="pre">DDAn</span></code>) represents a third way of characterising <span class="math notranslate nohighlight">\({\mathbf{\Gamma}}_\mathrm{e}\)</span> and  <span class="math notranslate nohighlight">\({\mathbf{Q}}_\mathrm{e}\)</span>.
It was deduced by an expansion of the electron velocity distribution function (EVDF) in Legendre polynomials and the derivation of the first four moment equations from the electron Boltzmann equation (<em>M. M. Becker, D. Loffhagen, AIP Adv. 3 (2013) 012108</em>, <em>M. M. Becker, D. Loffhagen, Adv. Pure Math. 3 (2013) 343</em>).
It reads</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}\mathbf{\Gamma}_\mathrm{e}
= -\frac{e_0}{m_\mathrm{e}\nu_\mathrm{e}}\nabla
\Bigl((\xi_0 + \xi_2)n_\mathrm{e} \Bigr)
-\frac{e_0}{m_\mathrm{e}\nu_\mathrm{e}} \mathbf{E} n_\mathrm{e}\,, \label{eq:JeDDAn}\\
%
\mathbf{Q}_\mathrm{e} = -\frac{e_0}{m_\mathrm{e}\tilde{\nu}_\mathrm{e}}\nabla
\Bigl((\tilde{\xi}_0 + \tilde{\xi}_2) w_\mathrm{e} \Bigr) \label{eq:QeDDAn}\\
\qquad\qquad\; -\frac{e_0}{m_\mathrm{e}\tilde{\nu}_\mathrm{e}}\Bigl(\frac{5}{3}
+ \frac{2}{3}\frac{\xi_2}{\xi_0}\Bigr)\mathbf{E} w_\mathrm{e}, \nonumber\end{split}\]</div>
</div></blockquote>
<p>and includes the momentum and energy flux dissipation frequencies <span class="math notranslate nohighlight">\(\nu_\mathrm{e}\)</span> and <span class="math notranslate nohighlight">\(\tilde{\nu}_\mathrm{e}\)</span>, respectively, the transport coefficients <span class="math notranslate nohighlight">\(\xi_0\)</span>, <span class="math notranslate nohighlight">\(\xi_2\)</span>, <span class="math notranslate nohighlight">\(\tilde{\xi}_0\)</span> and <span class="math notranslate nohighlight">\(\tilde{\xi}_2\)</span>, as well as electron mass <span class="math notranslate nohighlight">\(m_\mathrm{e}\)</span>.
It should be emphasized that this approximation is unique to the MCPlas toolbox, as to our knowledge it is not part of any other modelling tool.
Considering the accuracy improvements relative to the drift–diffusion approximation at low and atmospheric pressures (<em>M. Baeva, D. Loffhagen, M. M. Becker, D. Uhrlandt Plasma Chem. Plasma Process. 39 (4) (2019) 949–968</em>), it represents a highly significant feature of the toolbox.</p>
<p>Boundary conditions for the electron density and mean electron energy balance equations are included in MCPlas in accordance with the study given by Hagelaar <em>et al.</em> (<em>G. J. M. Hagelaar, F. J. de Hoog, G. M. W. Kroesen, Phys. Rev. E 62 (1) (2000) 1452</em>) and read</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}\mathbf{\Gamma}_\mathrm{e}\cdot\boldsymbol{\nu}
= \frac{1-r_\mathrm{e}}{1+r_\mathrm{e}}
\Bigl(\left|n_\mathrm{e} \mathbf{v}_{\mathrm{d},\mathrm{e}}\cdot\boldsymbol{\nu} \right|
+\frac{1}{2}n_\mathrm{e} v_{\mathrm{th},\mathrm{e}}\Bigr)
-\frac{2}{1+r_\mathrm{e}}\gamma\sum_i\max(\mathbf{\Gamma}_i\cdot\boldsymbol{\nu},0)
\label{eq:boundary_e}\,,\\
%
\mathbf{Q}_\mathrm{e}\cdot\boldsymbol{\nu}
= \frac{1-r_\mathrm{e}}{1+r_\mathrm{e}}
\Bigl(\left| w_\mathrm{e} \tilde{\mathbf{v}}_{\mathrm{d},\mathrm{e}}\cdot\boldsymbol{\nu} \right|
+\frac{2}{3} w_\mathrm{e} v_{\mathrm{th},\mathrm{e}}
\Bigr)
-\frac{2}{1+r_\mathrm{e}}
\gamma u_\mathrm{e}^\gamma
\sum_i\max(\mathbf{\Gamma}_i\cdot\boldsymbol{\nu},0)\,,\end{split}\]</div>
</div></blockquote>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{\nu}\)</span> represents the normal vector pointing toward the plasma boundaries, and <span class="math notranslate nohighlight">\(r_\mathrm{e}\)</span>, <span class="math notranslate nohighlight">\(\gamma\)</span>, <span class="math notranslate nohighlight">\(u_\mathrm{e}^\gamma\)</span> and <span class="math notranslate nohighlight">\(\mathbf{\Gamma}_i\)</span> denote the electron reflection coefficient, the secondary electron emission coefficient, mean energy of secondary electrons and the ion fluxes at the boundaries, respectively.
The vector of electron drift velocity <span class="math notranslate nohighlight">\(\mathbf{v}_{\mathrm{d},\mathrm{e}}\)</span>, the thermal velocity of electron <span class="math notranslate nohighlight">\(v_{\mathrm{th},\mathrm{e}}\)</span>, and the vector of electron energy drift velocity <span class="math notranslate nohighlight">\(\tilde{\mathbf{v}}_{\mathrm{d},\mathrm{e}}\)</span> in the case of the conventional drift-diffusion approximation (option <code class="docutils literal notranslate"><span class="pre">DDAc</span></code>) are defined as</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\mathbf{v}_{\mathrm{d},\mathrm{e}}
= -b_\mathrm{e} \mathbf{E}\, ,
\qquad
%
v_{\mathrm{th},\mathrm{e}}
= \sqrt{\frac{8 k_\mathrm{B} T_\mathrm{e}}{\pi m_\mathrm{e}}}\, ,
\qquad
%
\tilde{\mathbf{v}}_{\mathrm{d},\mathrm{e}}
= -\tilde{b}_\mathrm{e} \mathbf{E}\, ,\]</div>
</div></blockquote>
<dl>
<dt>while in the case of commonly used drift-diffusion approximation (option <code class="docutils literal notranslate"><span class="pre">DDA53</span></code>) the vector of electron energy drift velocity <span class="math notranslate nohighlight">\(\tilde{\mathbf{v}}_{\mathrm{d},\mathrm{e}}\)</span> is equal to <span class="math notranslate nohighlight">\(-\frac{5}{3}b_\mathrm{e}\mathbf{E}\)</span>. For the improved drift-diffusion approximation (option <code class="docutils literal notranslate"><span class="pre">DDAn</span></code>), <span class="math notranslate nohighlight">\(\mathbf{v}_{\mathrm{d},\mathrm{e}}\)</span> and <span class="math notranslate nohighlight">\(\tilde{\mathbf{v}}_{\mathrm{d},\mathrm{e}}\)</span> are defined differently, taking the expressions</dt><dd><div class="math notranslate nohighlight">
\[\begin{split}\mathbf{v}_{\mathrm{d},\mathrm{e}}
= -\frac{e_0}{m_\mathrm{e}\nu_\mathrm{e}} \mathbf{E}\, ,
\qquad
%\\
\tilde{\mathbf{v}}_{\mathrm{d},\mathrm{e}}
= -\frac{e_0}{m_\mathrm{e}\tilde{\nu}_\mathrm{e}}\Bigl(\frac{5}{3}
+ \frac{2}{3}\frac{\xi_2}{\xi_0}\Bigr) \mathbf{E}\, .
\qquad\end{split}\]</div>
</dd>
</dl>
<p>In above relations, <span class="math notranslate nohighlight">\(T_\mathrm{e} = 2u_\mathrm{e}/(3k_\mathrm{B})\)</span> is the temperature of electrons and <span class="math notranslate nohighlight">\(k_\mathrm{B}\)</span> is the Boltzmann constant.</p>
<p>The boundary condition for the balance equation of  heavy particle densities has the following form</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\mathbf{\Gamma}_\mathrm{h}\cdot\boldsymbol{\nu}
= \frac{1-r_\mathrm{h}}{1+r_\mathrm{h}}
\Bigl(\left|\mathrm{sgn}(q_\mathrm{h})
n_\mathrm{h} \mathbf{v}_{\mathrm{d},\mathrm{h}}  \cdot\boldsymbol{\nu}\right|
+\frac{1}{2} n_\mathrm{h} {v}_{\mathrm{th},\mathrm{h}} \Bigr),
%\]</div>
</div></blockquote>
<p>where the variables and coefficients associated to heavy particles are defined in a manner analogous to that of the electrons.</p>
<p>For the Poisson equation, the boundary conditions are defined by setting the applied voltage <span class="math notranslate nohighlight">\(U_\mathrm{a}\)</span> at the powered electrode and zero potential at the grounded electrode.
The accumulation of surface charges is additionally taken into account in the case of dielectric boundaries using the interface condition</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[- \varepsilon_\mathrm{r}
\varepsilon_0
\mathbf{E} \cdot \boldsymbol{\nu}
=
\sigma.\]</div>
</div></blockquote>
<p>Here, <span class="math notranslate nohighlight">\(\varepsilon_\mathrm{r}\)</span> is 1 in the plasma region, while in the dielectric region it has a value characteristic of the considered dielectric. The surface charge density <span class="math notranslate nohighlight">\(\sigma\)</span> is determined from the charged particle currents coming
onto the dielectric via equation</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\frac{\partial \sigma}{\partial t}
=
\sum_{j}q_j
\mathbf{\Gamma}_j \cdot \boldsymbol{\nu}.\]</div>
</div></blockquote>
<p>The source terms <span class="math notranslate nohighlight">\(S_j\)</span> of the electron density balance equations is defined as</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[S_j = \sum_{l=1}^{N_\mathrm{r}} (G_{jl} - L_{jl}) R_l,
\label{eq:S_j}\,\]</div>
</div></blockquote>
<p>where <span class="math notranslate nohighlight">\(R_l\)</span> is the reaction rate of reaction <span class="math notranslate nohighlight">\(l\)</span>, given by</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[R_l = k_l \prod_{i=1}^{N_\mathrm{s}} n_i^{\beta_{il}}.\]</div>
</div></blockquote>
<p>Here, <span class="math notranslate nohighlight">\(\beta_{il}\)</span> and <span class="math notranslate nohighlight">\(k_l\)</span> denote the partial reaction order of species <span class="math notranslate nohighlight">\(i\)</span> and the rate coefficient for reaction <span class="math notranslate nohighlight">\(l\)</span>. <span class="math notranslate nohighlight">\(N_\mathrm{r}\)</span> represents the number of reactions, while <span class="math notranslate nohighlight">\(N_\mathrm{s}\)</span> is the number of species considered in the model.
<span class="math notranslate nohighlight">\(G_{jl}\)</span> and <span class="math notranslate nohighlight">\(L_{jl}\)</span> are the gain and loss matrix elements, respectively, defined by the stoichiometric coefficients for the given species and reactions. MCPlas automatically generates these matrices from the RKM input data, which facilitates effortless switching between models with different levels of complexity.</p>
<p>The source terms <span class="math notranslate nohighlight">\(\tilde{S}_\mathrm{e}\)</span> of the electron energy balance equation is defined as</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\tilde{S}_\mathrm{e} = \sum_{l=1}^{N_\mathrm{r}} \tilde{R}_l,\]</div>
</div></blockquote>
<p>where <span class="math notranslate nohighlight">\(\tilde{R}_l\)</span> is the electron energy rate for reaction <span class="math notranslate nohighlight">\(l\)</span>, which is usually defined as reaction rate <span class="math notranslate nohighlight">\(R_l\)</span> multiplied by the net electron energy change (gain or loss) <span class="math notranslate nohighlight">\(\Delta\varepsilon_l\)</span>.
In the case where electron energy rate coefficient <span class="math notranslate nohighlight">\(\tilde{k}_l\)</span> is defined, e.g.for elastic collision, <span class="math notranslate nohighlight">\(\tilde{R}_l\)</span> is determined as <span class="math notranslate nohighlight">\(\tilde{k}_l \prod_{i=1}^{N_\mathrm{s}} n_i^{\beta_{il}}\)</span>.
For reactions in which electrons do not participate <span class="math notranslate nohighlight">\(\tilde{R}_l\)</span> is equal to zero.</p>
<p>To ensure numerical stability and obtain consistent solutions, MCPlas uses some stabilisation techniques.
One such approach involves the logarithmic transformation of the densities of particle species and the mean electron energy.
This inherently enforces positivity and suppresses oscillations in regions with steep gradients or low concentrations
The toolbox also implements a source term stabilisation method applicable to all particles and electron energy balance equations, in a similar way to that used in Comsol Plasma Module.
This term is designed to counteract numerical instabilities caused by stiff or nonlinear reactions.
It acts as a buffer at very low particle number densities, preventing the appearance of negative values, and becomes negligible at higher number densities.</p>
</section>
<section id="structure">
<h2>Structure<a class="headerlink" href="#structure" title="Link to this heading">¶</a></h2>
<p>The code directory has the following structure:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>MCPlas
├── applications
│
├── docs
│
├── plasma
│
├── schemas
│
├── toolbox
│
└── MCPlas.m
</pre></div>
</div>
<div class="toctree-wrapper compound">
</div>
<section id="application">
<h3>application<a class="headerlink" href="#application" title="Link to this heading">¶</a></h3>
<p>This folder serves as the central location for organizing geometry-specific modeling cases.
It contains subfolders such as Generic1D, Generic1p5D, Generic2D, and Generic2p5D, each corresponding to a particular modelling geometry.
Within each subfolder, there are dedicated MATLAB scripts responsible for defining the geometry, generating the mesh, and configuring project-specific properties such as solvers and study steps.
Each case also includes a General JSON input file that provides essential settings tailored to that specific geometry (options <code class="docutils literal notranslate"><span class="pre">1D</span></code>, <code class="docutils literal notranslate"><span class="pre">1p5D</span></code>, <code class="docutils literal notranslate"><span class="pre">2D</span></code>, <code class="docutils literal notranslate"><span class="pre">2p5D</span></code>).
The General JSON input file should be prepared using Adamant web-tool.
How to prepare this input file will be explaned in some of the next sections.
After the model-building process is completed, the resulting .mph file is automatically saved in the same subfolder, keeping all related files organized and localized.</p>
<section id="generic1d">
<h4>Generic1D<a class="headerlink" href="#generic1d" title="Link to this heading">¶</a></h4>
<p>The Generic1D subfolder is dedicated to application of one-dimensional, time-dependent plasma modeling.
It contains MATLAB scripts that define the geometry, mesh, and project settings specific to 1D simulations.
This modeling case is designed to support plasma source configurations featuring either rectangular or circular electrodes (figure 1), making it suitable for simplified yet physically relevant geometries.
The correct specification of electrode dimensions is crucial and must be provided accurately in the associated General JSON input file.</p>
<figure class="align-center" id="id1">
<a class="reference internal image-reference" href="_images/1D.svg"><img alt="_images/1D.svg" src="_images/1D.svg" width="75%" /></a>
<figcaption>
<p><span class="caption-text">Figure 1, 1D modelling geometry.</span><a class="headerlink" href="#id1" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_application/Generic1D/SetGeometry.html">SetGeometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_application/Generic1D/SetMesh.html">SetMesh</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_application/Generic1D/SetProject.html">SetProject</a></li>
</ul>
</div>
<ul class="simple">
<li><p><strong>Generic1D.mph</strong></p></li>
<li><p><strong>General_input_data.json</strong></p></li>
</ul>
</section>
<section id="generic1p5d">
<h4>Generic1p5D<a class="headerlink" href="#generic1p5d" title="Link to this heading">¶</a></h4>
<p>The Generic1p5D subfolder is dedicated to application of one-dimensional, time-dependent plasma modeling in polar coordinates.
It contains MATLAB scripts that configure the geometry, meshing, and project settings only for coaxial plasma source configurations (figure 2).
This requires that electrode dimensions—such as radius of inner and outer electrodes—be accurately defined in the corresponding General JSON input file.
These inputs determine the plasma domain and boundary conditions essential for correct simulation behavior.</p>
<figure class="align-center" id="id2">
<a class="reference internal image-reference" href="_images/1p5D.svg"><img alt="_images/1p5D.svg" src="_images/1p5D.svg" width="75%" /></a>
<figcaption>
<p><span class="caption-text">Figure 2, 1p5D modelling geometry for simulations in polar coordiantes.</span><a class="headerlink" href="#id2" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_application/Generic1p5D/SetGeometry.html">SetGeometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_application/Generic1p5D/SetMesh.html">SetMesh</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_application/Generic1p5D/SetProject.html">SetProject</a></li>
</ul>
</div>
<ul class="simple">
<li><p><strong>Generic1p5D.mph</strong></p></li>
<li><p><strong>General_input_data.json</strong></p></li>
</ul>
</section>
<section id="generic2d">
<h4>Generic2D<a class="headerlink" href="#generic2d" title="Link to this heading">¶</a></h4>
<p>The Generic2D subfolder is dedicated to application of two-dimensional, time-dependent plasma modeling in Cartesian coordinates.
It contains MATLAB scripts responsible for setting up the geometry, mesh, and project configuration for rectangular electrodes (figure 3).
The dimensions and positions of the rectangular electrodes must be properly specified in the associated General JSON input file.</p>
<figure class="align-center" id="id3">
<a class="reference internal image-reference" href="_images/2D.svg"><img alt="_images/2D.svg" src="_images/2D.svg" width="75%" /></a>
<figcaption>
<p><span class="caption-text">Figure 3, 2D modelling geometry for simulations in Cartesian coordinates.</span><a class="headerlink" href="#id3" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_application/Generic2D/SetGeometry.html">SetGeometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_application/Generic2D/SetMesh.html">SetMesh</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_application/Generic2D/SetProject.html">SetProject</a></li>
</ul>
</div>
<ul class="simple">
<li><p><strong>Generic2D.mph</strong></p></li>
<li><p><strong>General_input_data.json</strong></p></li>
</ul>
</section>
<section id="generic2p5d">
<h4>Generic2p5D<a class="headerlink" href="#generic2p5d" title="Link to this heading">¶</a></h4>
<p>The Generic2p5D subfolder is dedicated to the application of two-dimensional, time-dependent plasma modeling in cylindrical coordinates.
It contains MATLAB scripts responsible for setting up the geometry, mesh, and project configuration for plasma sources with rectangular or circular electrode shapes (figure 4).
The dimensions and positions of both rectangular and circular electrodes must be properly specified in the associated General JSON input file, as they directly affect domain generation and boundary condition assignment.</p>
<figure class="align-center" id="id4">
<a class="reference internal image-reference" href="_images/2p5D.svg"><img alt="_images/2p5D.svg" src="_images/2p5D.svg" width="75%" /></a>
<figcaption>
<p><span class="caption-text">Figure 4, 2D modelling geometry for simulations in cylindrical coordinates.</span><a class="headerlink" href="#id4" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_application/Generic2p5D/SetGeometry.html">SetGeometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_application/Generic2p5D/SetMesh.html">SetMesh</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_application/Generic2p5D/SetProject.html">SetProject</a></li>
</ul>
</div>
<ul class="simple">
<li><p><strong>Generic2p5D.mph</strong></p></li>
<li><p><strong>General_input_data.json</strong></p></li>
</ul>
</section>
</section>
<section id="docs">
<h3>docs<a class="headerlink" href="#docs" title="Link to this heading">¶</a></h3>
<p>All the necessary files for the MCPlas Toolbox documentation are stored in this folder.</p>
</section>
<section id="plasma">
<h3>plasma<a class="headerlink" href="#plasma" title="Link to this heading">¶</a></h3>
<p>The input data necessary for running MCPlas includes information about the RKM, transport properties of the particle species, as well as general information about the modelling geometry, operating conditions, properties of the plasma source and fluid model properties.
These data represent a heterogeneous data set that requires a standardised schema to be verified.
MCPlas adopts an extended version of the format proposed by the LXCat platform(open-source) (<em>E. Carbone, W. Graef, G. Hagelaar, D. Boer, M. M. Hopkins, J. C. Stephens, B. T. Yee, S. Pancheshnyi, J. van Dijk, L. Pitchford,  Atoms 9 (1) (2021) 1</em>, <em>D. Boer, S. Verhoeven, S. Ali, W. Graef, J. van Dijk, LXCat. URL https://github.com/LXCat-project/LXCat</em>).
The basic, top-level structure of the JSON data describing an RKM is shown in figure 5.
It comprises three main properties: <em>references</em>; an object storing the references from which included data are extracted, <em>states</em>; an object listing all the states of the particle species considered, and <em>processes</em>; an array of process objects that provide information on the reaction equations and corresponding data.
Each individual element of the JSON document is accurately defined by a corresponding JSON schema definition.
The exact definition of the LXCat schemas can be found in the LXCat GitHub repository (<em>D. Boer, S. Verhoeven, S. Ali, W. Graef, J. van Dijk, LXCat. URL https://github.com/LXCat-project/LXCat</em>).
These schemas can also be used to validate incoming documents.
The development of MCPlas has contributed to the extension of the existing electron scattering schemas to further accommodate plasma chemistry data.</p>
<figure class="align-center" id="id5">
<a class="reference internal image-reference" href="_images/File_structure.png"><img alt="_images/File_structure.png" src="_images/File_structure.png" style="width: 75%;" /></a>
<figcaption>
<p><span class="caption-text">Figure 5, A schematic representing the top-level structure of an LXCat JSON document for LTP input data.</span><a class="headerlink" href="#id5" title="Link to this image">¶</a></p>
<div class="legend">
<p>Here are two JSON input data files for argon 4-species and 23-species RKM:</p>
</div>
</figcaption>
</figure>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_plasma/Ar_Becker_2009.html">Ar_Becker_2009</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_plasma/Ar_Stankov_2022.html">Ar_Stankov_2022</a></li>
</ul>
</div>
</section>
<section id="schemas">
<h3>schemas<a class="headerlink" href="#schemas" title="Link to this heading">¶</a></h3>
<p>Inside this folder, you will find the JSON schema used to define general input data via the Adamant web tool.
Further details about this file can be found in the <em>Preparation of general input data</em> section.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_schemas/General_JSON_schema.html">General_JSON_schema</a></li>
</ul>
</div>
</section>
<section id="toolbox">
<h3>toolbox<a class="headerlink" href="#toolbox" title="Link to this heading">¶</a></h3>
<p>This folder in the MCPlas toolbox contains a collection of MATLAB functions essential for building a COMSOL model using the MATLAB LiveLink module.
These functions automate model generation by systematically calling COMSOL-specific commands to define all essential features of the model.
By organizing model-building tasks into modular scripts, the folder ensures clarity, maintainability, and flexibility of the model building process.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_toolbox/ReadJSON.html">ReadJSON</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_toolbox/InpRKM.html">InpRKM</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_toolbox/InpGeneral.html">InpGeneral</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_toolbox/SetParameters.html">SetParameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_toolbox/SetConstants.html">SetConstants</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_toolbox/SetVariables.html">SetVariables</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_toolbox/SetTransportCoefficients.html">SetTransportCoefficients</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_toolbox/SetRateCoefficients.html">SetRateCoefficients</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_toolbox/SetEnergyRateCoefficients.html">SetEnergyRateCoefficients</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_toolbox/SetRates.html">SetRates</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_toolbox/SetEnergyRates.html">SetEnergyRates</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_toolbox/SetFluxes.html">SetFluxes</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_toolbox/SetSources.html">SetSources</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_toolbox/SetProbesAndGraphs.html">SetProbesAndGraphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_toolbox/AddSurfaceChargeAccumulation.html">AddSurfaceChargeAccumulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_toolbox/AddPoissonEquation.html">AddPoissonEquation</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_toolbox/AddFluidEquations.html">AddFluidEquations</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_toolbox/SetElectrical.html">SetElectrical</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_toolbox/SetSelection.html">SetSelection</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_toolbox/msg.html">msg</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_toolbox/num2strcell.html">num2strcell</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_toolbox/IsModelMember.html">IsModelMember</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_toolbox/ActivatePlasma.html">ActivatePlasma</a></li>
</ul>
</div>
</section>
<section id="mcplas-m">
<h3>MCPlas.m<a class="headerlink" href="#mcplas-m" title="Link to this heading">¶</a></h3>
<p>This script serves as the core file of the MCPlas toolbox.
It begins by loading user-defined chemistry and general model settings from JSON files, parsing them into structured input objects.
After initializing the COMSOL environment and defining the working path, it systematically calls MATLAB functions to establish parameters, geometry, physical constants, variables, transport and reaction coefficients, and model equations.
It configures electrical conditions, surface effects, and postprocessing elements like probes and plots.
Meshing and solver settings are finalized before the complete model is saved as a .mph file.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="manual_rst_MCPlas/MCPlas.html">MCPlas.m</a></li>
</ul>
</div>
</section>
</section>
<section id="preparation-of-general-input-data">
<h2>Preparation of general input data<a class="headerlink" href="#preparation-of-general-input-data" title="Link to this heading">¶</a></h2>
<p>In addition to the input data specifying the RKM and the species transport properties, general input data defining the setup are required to build the model.
These general input data are provided in the JSON format as well and include information on plasma source, plasma medium, and diagnostics method.
The plasma source field describes the geometry, electrical, and material properties of the source.
The plasma medium field encompasses the general characteristics of the gas under study, as well as the surface properties specific to the included species and surface materials.
Finally, the diagnostics field contains the relevant properties of the fluid-Poisson model, which is employed here as a diagnostic tool for investigation.</p>
<p>For the preparation of the general input data in JSON data format, employing the Adamant tool (<a class="reference external" href="https://plasma-mds.github.io/adamant/">https://plasma-mds.github.io/adamant/</a>) for collection of JSON schema-based metadata is proposed.
This tool is primarily intended to facilitate the implementation of digital research data management processes by enabling easy compilation and creation of metadata and metadata schemas based on JSON schema standards. All the features of the Adamant are very convenient for generating the JSON data format containing all general input data necessary for model building.
In general, Adamant can generate JSON data files based on the included JSON schema.
The JSON schema can be included in three ways: (i) selecting one of the existing schemas, (ii) uploading a schema already prepared by the user, or (iii) creating a schema from scratch directly on the platform.
The MCPlas toolbox comes with a prepared JSON schema to collect the required general input data based on Plasma-MDS~(<em>S. Franke, L. Paulet, J. Sch¨afer, D. O’Connell, M. M. Becker, Sci. Data (2020) 439</em>), a metadata schema for plasma science.
The user has to upload the provided JSON schema to the Adamant platform and start the rendering process.
Subsequently, Adamant automatically generates an interactive web-form, whose elements correspond to the general input data that the user has to complete.
Compiling the fully defined web-form generates a JSON data file containing all general input data needed for the model building with MCPlas.
If the user wants to make a modelling analysis with changed general input data, they just need to generate a modified JSON data file.
For the purposes of MCPlas, Plasma-MDS was specifically extended to correspond to the general input data required to set up the fluid-Poisson model in COMSOL.
With this, the procedure is designed to promote the further implementation of the FAIR data principles to plasma modelling.</p>
</section>
<section id="how-to-use-it">
<h2>How to use it<a class="headerlink" href="#how-to-use-it" title="Link to this heading">¶</a></h2>
<section id="mcplas-workflow">
<h3>MCPlas workflow<a class="headerlink" href="#mcplas-workflow" title="Link to this heading">¶</a></h3>
<p>The general concept of the MCPlas toolbox is given by the workflow presented in figure 6.
At the beginning of the MCPlas workflow, as a first step, all input data necessary for setting up the model must be provided.
This considers general input data and plasma chemistry prepared in JSON data format.
The second step of the MCPlas workflow involves setting up the model by executing the main MATLAB script, MCPlas.m.
This script systematically calls MATLAB functions (listed in section <em>toolbox</em>) specifically designed for the toolbox.
The second and third steps automatically execute after running the MCPlas code, and they are not the user’s concern.</p>
<figure class="align-center" id="id6">
<a class="reference internal image-reference" href="_images/MCPlas_workflow.png"><img alt="_images/MCPlas_workflow.png" src="_images/MCPlas_workflow.png" style="width: 75%;" /></a>
<figcaption>
<p><span class="caption-text">Figure 6, MCPlas worklow.</span><a class="headerlink" href="#id6" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="step-by-step-tutorial">
<h3>Step-by-step tutorial<a class="headerlink" href="#step-by-step-tutorial" title="Link to this heading">¶</a></h3>
<p>Watch a live demonstration of generating a COMSOL model using MCPlas.
The demo covers everything from the initial toolbox setup to generating and running the resulting COMSOL file, with detailed steps and explanations throughout.</p>
<div  class="sphinx-contrib-video-container align-left"><video autoplay="True" controls="True" height="360" preload="auto" width="640"><source src="_images/my_video.mp4" type="video/mp4"></video></div></section>
</section>
</section>
<section id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Link to this heading">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="sphinx-toc sphinxlocaltoc">
    <h3><a href="#">Page contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Welcome to MCPlas toolbox!</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#structure">Structure</a><ul>
<li><a class="reference internal" href="#application">application</a><ul>
<li><a class="reference internal" href="#generic1d">Generic1D</a></li>
<li><a class="reference internal" href="#generic1p5d">Generic1p5D</a></li>
<li><a class="reference internal" href="#generic2d">Generic2D</a></li>
<li><a class="reference internal" href="#generic2p5d">Generic2p5D</a></li>
</ul>
</li>
<li><a class="reference internal" href="#docs">docs</a></li>
<li><a class="reference internal" href="#plasma">plasma</a></li>
<li><a class="reference internal" href="#schemas">schemas</a></li>
<li><a class="reference internal" href="#toolbox">toolbox</a></li>
<li><a class="reference internal" href="#mcplas-m">MCPlas.m</a></li>
</ul>
</li>
<li><a class="reference internal" href="#preparation-of-general-input-data">Preparation of general input data</a></li>
<li><a class="reference internal" href="#how-to-use-it">How to use it</a><ul>
<li><a class="reference internal" href="#mcplas-workflow">MCPlas workflow</a></li>
<li><a class="reference internal" href="#step-by-step-tutorial">Step-by-step tutorial</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>

  </div>
  <div class="sphinxnext">
    <h4>Next page</h4>
    <p class="topless"><a href="manual_rst_application/Generic1D/SetGeometry.html"
                          title="Next page">&rarr; SetGeometry</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="manual_rst_application/Generic1D/SetGeometry.html" title="SetGeometry"
             >next</a> &nbsp; &nbsp;</li>
    <li><a href="#">MATLAB Sphinx Documentation Test  documentation</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">Welcome to MCPlas toolbox!</a></li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
    &#169; Copyright 2014, Mark Mikofski.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>